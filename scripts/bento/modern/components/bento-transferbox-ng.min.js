/**
 * Bento Modern v0.8.13
 * Copyright 2015 Thomson Reuters
 * Maintained by Chi Gao, Joe Huang, Aaron Mendez
 */
!function(a,b){"use strict";a.module("bento.transferbox",["bento.cookie","pascalprecht.translate"]).config(["$translateProvider","$bentoTranslateLoaderProvider","$bentoJSRootProvider","$bentoCookieProvider",function(a,b,c,d){var e=d.getCookie("uiCulture","en");c.configAngularTranslateProvider("bento-transferbox",a,b,e)}]).controller("bentoTransferBoxController",["$scope",function(a){var c=260;a.selectItems=[{value:25,label:25},{value:50,label:50},{value:100,label:100}],a.currentInfo={page:1,gridData:[],assignedData:[],selectedUsersArray:[],availableSearchTerm:"",assignedSearchTerm:"",selectedAvailableItems:[],selectedAssignedItems:[],totalAvailableItems:0,totalAssignedItems:0,availableItemsPage:1,assignedItemsPage:1,numItemsAvailable:25,numItemsAssigned:25,transferBtnText:"Transfer",selectedTitle:"Selected Users",availableTitle:"Available Users",boxOneClickState:!1,boxTwoClickState:!1,dataTable1:b,dataTable2:b,infoText:"_SELECTED_ of _TOTAL_ Checked",paginationInfoText:"_START_ to _END_ of _MAX_ Entries",paginationGoText:"Go",paginationInfoPageText:"Page _PAGE_ of _PAGES_",boxOneInfoText:"",boxTwoInfoText:"",boxOneInfoShown:!1,boxTwoInfoShown:!1,columnDefinitions:b,columnFilterDefinitions:b,columnFilterToggle:!1,uniqueKey:""},a.numItemsAvailable=10,a.dataTable=b,a.buttons=[],a.tableOptions={autoWidth:!1,stateSave:!1,paginate:!0,deferRender:!0,filter:!0,destroy:!1,processing:!0,ordering:!0,order:[],dom:'<"top">rt<"bottom"f><"clear">SR'},a.tableOptions.scrollY=a.height-c+"px"}]).directive("bentoTransferbox",["$timeout","$translate",function(c,d){return{restrict:"AE",scope:{boxOneItemSource:"=",boxTwoItemSource:"=",columnDefinitions:"=",columnFilterDefinitions:"=",boxOneTitle:"@",boxTwoTitle:"@",infoText:"@",transferBtnText:"@",height:"=",onTransfer:"&",lang:"=",uniqueKey:"@",paginationInfoText:"@",paginationGoText:"@",paginationInfoPageText:"@"},controller:"bentoTransferBoxController",templateUrl:"../templates/transfer_box/bento-transferbox.html",replace:!0,link:function(e,f,g){function h(){e.currentInfo.dataTable1&&e.currentInfo.dataTable2&&(e.currentInfo.dataTable1.column(0).data().sort(),e.currentInfo.dataTable2.column(0).data().sort())}function i(){g.columnDefinitions&&(e.currentInfo.columnDefinitions=e.columnDefinitions)}function j(){g.columnFilterDefinitions&&(e.currentInfo.columnFilterDefinitions=e.columnFilterDefinitions,e.currentInfo.columnFilterToggle=!0)}function k(){e.currentInfo.boxOneInfoText=e.currentInfo.selectedAvailableItems.length>0?e.currentInfo.infoText.replace("_SELECTED_",e.currentInfo.selectedAvailableItems.length).replace("_TOTAL_",e.currentInfo.totalAvailableItems):e.currentInfo.totalAvailableItems,e.currentInfo.boxTwoInfoText=e.currentInfo.selectedAssignedItems.length>0?e.currentInfo.infoText.replace("_SELECTED_",e.currentInfo.selectedAssignedItems.length).replace("_TOTAL_",e.currentInfo.totalAssignedItems):e.currentInfo.totalAssignedItems,o=f[0].getElementsByClassName("transferbox-btn")[0].offsetWidth+f[0].getElementsByClassName("transferbox-header-title")[0].offsetWidth,p=f[0].getElementsByClassName("transferbox-btn")[1].offsetWidth+f[0].getElementsByClassName("transferbox-header-title")[1].offsetWidth+15}function l(){e.currentInfo.boxOneClickState=!1,e.currentInfo.boxTwoClickState=!1}function m(){e.boxOneItemSource=e.currentInfo.gridData,e.boxTwoItemSource=e.currentInfo.assignedData,e.onTransfer({gridDataOne:e.currentInfo.gridData,gridDataTwo:e.currentInfo.assignedData})}function n(){var b=a.element(f).find("table:eq(1)"),d=a.element(f).find("table:eq(3)");b.width("100%"),d.width("100%");var g=f[0].getElementsByClassName("transferbox-header")[0].offsetWidth-50,h=f[0].getElementsByClassName("transferbox-header")[1].offsetWidth-40;c(function(){e.currentInfo.boxOneInfoShown=o>g?!1:!0,e.currentInfo.boxTwoInfoShown=p>h?!1:!0},0)}var o=0,p=0;e.transferItems=function(a){var b=e.currentInfo.selectedAssignedItems,c=e.currentInfo.assignedData,d=e.currentInfo.gridData;"toAssigned"===a&&(b=e.currentInfo.selectedAvailableItems,c=e.currentInfo.gridData,d=e.currentInfo.assignedData),h();for(var f=b.length-1;f>=0;f--)for(var g=0,i=c.length;i>g;g++)c[g]&&c[g].id===JSON.parse(b[f])&&d.unshift(c.splice(g,1)[0]);e.currentInfo.selectedAssignedItems=[],e.currentInfo.selectedAvailableItems=[],n(),l(),m()},g.lang!==b&&e.$watch("lang",function(a){e.lang&&(e.language=a,d.use(e.lang).then(function(){d("TRANSFER_BOX_INFO_TEXT").then(function(a){e.currentInfo.infoText=a,k()}),d("TRANSFER_BOX_BTN_TEXT").then(function(a){e.currentInfo.transferBtnText=a})}))}),g.infoText&&e.$watch("infoText",function(a){e.currentInfo.infoText=a,k()}),g.uniqueKey&&e.$watch("uniqueKey",function(a){e.currentInfo.uniqueKey=a}),g.paginationInfoText&&e.$watch("paginationInfoText",function(a){e.currentInfo.paginationInfoText=a}),g.paginationInfoPageText&&e.$watch("paginationInfoPageText",function(a){e.currentInfo.paginationInfoPageText=a}),g.paginationGoText&&e.$watch("paginationGoText",function(a){e.currentInfo.paginationGoText=a}),g.transferBtnText&&e.$watch("transferBtnText",function(a){e.currentInfo.transferBtnText=a}),e.$watchCollection("boxOneItemSource",function(a){i(),j(),a&&(e.currentInfo.gridData=a,e.currentInfo.totalAvailableItems=a.length),n()}),e.$watchCollection("boxTwoItemSource",function(a){i(),j(),a&&(e.currentInfo.assignedData=a,e.currentInfo.totalAssignedItems=a.length),n()}),e.$watch("columnFilterDefinitions",function(){j()}),e.$watch("columnDefinitions",function(){i()}),e.$watch("boxOneTitle",function(a){e.currentInfo.availableTitle=a}),e.$watch("boxTwoTitle",function(a){e.currentInfo.selectedTitle=a}),e.$watchCollection("currentInfo.selectedAvailableItems",function(){k()}),e.$watchCollection("currentInfo.selectedAssignedItems",function(){k()}),e.$watch("currentInfo.totalAssignedItems",function(){k()}),e.$watch("currentInfo.totalAvailableItems",function(){k()}),e.onTableCreatedRight=function(a){e.currentInfo.dataTable2=a,n()},e.onTableCreatedLeft=function(a){e.currentInfo.dataTable1=a,n()},e.onTableDrawn=function(){n(),k()},e.onSplitterResize=function(){n()}}}}])}(window.angular);